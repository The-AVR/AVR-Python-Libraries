{
    "asyncapi": "2.5.0",
    "info": {
        "title": "Bell AVR MQTT Message Spec",
        "version": "1.0"
    },
    "channels": {
        "avr/pcm/color/set": {
            "publish": {
                "message": {
                    "$ref": "#/components/messages/AVRPCMColorSet"
                },
                "description": "Set the color of the LED strip on the PCC."
            }
        },
        "avr/pcm/color/timed": {
            "publish": {
                "message": {
                    "$ref": "#/components/messages/AVRPCMColorTimed"
                },
                "description": "Set the color of the LED strip on the PCC temporarily."
            }
        },
        "avr/pcm/laser/fire": {
            "publish": {
                "message": {
                    "$ref": "#/components/messages/AVRPCMLaserFire"
                },
                "description": "Fires the laser for a 0.25 second pulse. Has a cooldown of 0.5 seconds."
            }
        },
        "avr/pcm/laser/on": {
            "publish": {
                "message": {
                    "$ref": "#/components/messages/AVRPCMLaserOn"
                },
                "description": "Turns laser on for 0.1 second every 0.5 seconds."
            }
        },
        "avr/pcm/laser/off": {
            "publish": {
                "message": {
                    "$ref": "#/components/messages/AVRPCMLaserOff"
                },
                "description": "Turns off laser. Does not prevent `laser/fire`."
            }
        },
        "avr/pcm/servo/open": {
            "publish": {
                "message": {
                    "$ref": "#/components/messages/AVRPCMServoOpen"
                },
                "description": "Opens a specific servo."
            }
        },
        "avr/pcm/servo/close": {
            "publish": {
                "message": {
                    "$ref": "#/components/messages/AVRPCMServoClose"
                },
                "description": "Closes a specific servo."
            }
        },
        "avr/pcm/servo/pwm/min": {
            "publish": {
                "message": {
                    "$ref": "#/components/messages/AVRPCMServoPWMMin"
                },
                "description": "Set the minimum pulse width of a specific servo."
            }
        },
        "avr/pcm/servo/pwm/max": {
            "publish": {
                "message": {
                    "$ref": "#/components/messages/AVRPCMServoPWMMax"
                },
                "description": "Set the maximum pulse width of a specific servo."
            }
        },
        "avr/pcm/servo/percent": {
            "publish": {
                "message": {
                    "$ref": "#/components/messages/AVRPCMServoPercent"
                },
                "description": "Set the percentage of a specific servo."
            }
        },
        "avr/pcm/servo/absolute": {
            "publish": {
                "message": {
                    "$ref": "#/components/messages/AVRPCMServoAbsolute"
                },
                "description": "Set the absolute position of a specific servo."
            }
        },
        "avr/fcm/hil_gps/stats": {
            "subscribe": {
                "message": {
                    "$ref": "#/components/messages/AVRFCMHILGPSStats"
                },
                "description": "This reports statistics on the HIL GPS data that is fed into the flight controller."
            }
        }
    },
    "components": {
        "schemas": {
            "wrgb": {
                "description": "A list of 4 integers between 0 and 255 to set the base color of the LEDs. This is in order of Red, Green, Blue, and Alpha",
                "type": "array",
                "minItems": 4,
                "maxItems": 4,
                "items": {
                    "description": "Color value.",
                    "type": "integer"
                }
            },
            "servo": {
                "description": "ID of the servo. This is 0-indexed.",
                "type": "integer",
                "minimum": 0,
                "maximum": 15
            },
            "pulse": {
                "description": "Pulse width.",
                "type": "integer",
                "minimum": 0,
                "maximum": 1000
            }
        },
        "messages": {
            "AVRPCMColorSet": {
                "payload": {
                    "type": "object",
                    "additionalProperties": false,
                    "required": [
                        "wrgb"
                    ],
                    "properties": {
                        "wrgb": {
                            "$ref": "#/components/schemas/wrgb"
                        }
                    }
                }
            },
            "AVRPCMColorTimed": {
                "payload": {
                    "type": "object",
                    "additionalProperties": false,
                    "required": [
                        "wrgb"
                    ],
                    "properties": {
                        "wrgb": {
                            "$ref": "#/components/schemas/wrgb"
                        },
                        "time": {
                            "description": "Number of seconds the color should be set for. Default is 0.5.",
                            "type": "number",
                            "minimum": 0,
                            "default": 0.5
                        }
                    }
                }
            },
            "AVRPCMLaserFire": {
                "payload": {
                    "type": "object",
                    "additionalProperties": false
                }
            },
            "AVRPCMLaserOn": {
                "payload": {
                    "type": "object",
                    "additionalProperties": false
                }
            },
            "AVRPCMLaserOff": {
                "payload": {
                    "type": "object",
                    "additionalProperties": false
                }
            },
            "AVRPCMServoOpen": {
                "payload": {
                    "type": "object",
                    "additionalProperties": false,
                    "required": [
                        "servo"
                    ],
                    "properties": {
                        "servo": {
                            "$ref": "#/components/schemas/servo"
                        }
                    }
                }
            },
            "AVRPCMServoClose": {
                "payload": {
                    "type": "object",
                    "additionalProperties": false,
                    "required": [
                        "servo"
                    ],
                    "properties": {
                        "servo": {
                            "$ref": "#/components/schemas/servo"
                        }
                    }
                }
            },
            "AVRPCMServoPWMMin": {
                "payload": {
                    "type": "object",
                    "additionalProperties": false,
                    "required": [
                        "servo",
                        "pulse"
                    ],
                    "properties": {
                        "servo": {
                            "$ref": "#/components/schemas/servo"
                        },
                        "pulse": {
                            "$ref": "#/components/schemas/pulse"
                        }
                    }
                }
            },
            "AVRPCMServoPWMMax": {
                "payload": {
                    "type": "object",
                    "additionalProperties": false,
                    "required": [
                        "servo",
                        "pulse"
                    ],
                    "properties": {
                        "servo": {
                            "$ref": "#/components/schemas/servo"
                        },
                        "pulse": {
                            "$ref": "#/components/schemas/pulse"
                        }
                    }
                }
            },
            "AVRPCMServoPercent": {
                "payload": {
                    "type": "object",
                    "additionalProperties": false,
                    "required": [
                        "servo",
                        "percent"
                    ],
                    "properties": {
                        "servo": {
                            "$ref": "#/components/schemas/servo"
                        },
                        "percent": {
                            "description": "Servo percent. 0 is closed, and 100 is open.",
                            "type": "integer",
                            "minimum": 0,
                            "maximum": 100
                        }
                    }
                }
            },
            "AVRPCMServoAbsolute": {
                "payload": {
                    "type": "object",
                    "additionalProperties": false,
                    "required": [
                        "servo",
                        "position"
                    ],
                    "properties": {
                        "servo": {
                            "$ref": "#/components/schemas/servo"
                        },
                        "position": {
                            "description": "Absolute position between SERVOMIN (closed) and SERVOMAX (open).",
                            "type": "integer",
                            "minimum": 150,
                            "maximum": 425
                        }
                    }
                }
            },
            "AVRFCMHILGPSStats": {
                "payload": {
                    "type": "object",
                    "additionalProperties": false,
                    "required": [
                        "frames"
                    ],
                    "properties": {
                        "frames": {
                            "description": "The number of messages that have been sent to the flight controller since the software has started.",
                            "type": "integer"
                        }
                    }
                }
            }
        }
    }
}